#!/usr/bin/env node
import allowedOptions from './../lib/options.js';
import { CloudflareCli } from './../index.js';
import { ConfigReader } from './../lib/configReader.js';
import minimist from 'minimist';
let argv = minimist(process.argv.slice(2), allowedOptions);
let configFile = argv.config || '~/.cfcli.yml';
let config = {};
try {
  config = new ConfigReader(configFile).readConfig(argv.account);
} catch (error) {
  console.log(error.message);
  process.exit(1);
}
let params = { ...config, ...argv };
// Throw error if both token and email are provided
// The old API Key authentication (email + key) is deprecated and causes issues with newer axios
if (params.token && params.email) {
  console.error('Error: Cannot use both "token" and "email" parameters. Please remove "email" from your configuration as API Key authentication is deprecated.');
  process.exit(1);
}
let cli = new CloudflareCli(params);
cli.runCommand(argv._[0], params);
